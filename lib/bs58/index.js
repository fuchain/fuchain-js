"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _Buffer = require("../safe-buffer").Buffer;

function basex(ALPHABET) {
  if (ALPHABET.length >= 255) {
    throw new TypeError("Alphabet too long");
  }
  var BASE_MAP = new Uint8Array(256);
  BASE_MAP.fill(255);
  for (var i = 0; i < ALPHABET.length; i++) {
    var x = ALPHABET.charAt(i);
    var xc = x.charCodeAt(0);
    if (BASE_MAP[xc] !== 255) {
      throw new TypeError(x + " is ambiguous");
    }
    BASE_MAP[xc] = i;
  }
  var BASE = ALPHABET.length;
  var LEADER = ALPHABET.charAt(0);
  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up
  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up
  function encode(source) {
    if (!_Buffer.isBuffer(source)) {
      throw new TypeError("Expected Buffer");
    }
    if (source.length === 0) {
      return "";
    }
    // Skip & count leading zeroes.
    var zeroes = 0;
    var length = 0;
    var pbegin = 0;
    var pend = source.length;
    while (pbegin !== pend && source[pbegin] === 0) {
      pbegin++;
      zeroes++;
    }
    // Allocate enough space in big-endian base58 representation.
    var size = (pend - pbegin) * iFACTOR + 1 >>> 0;
    var b58 = new Uint8Array(size);
    // Process the bytes.
    while (pbegin !== pend) {
      var carry = source[pbegin];
      // Apply "b58 = b58 * 256 + ch".
      var i = 0;
      for (
      var it1 = size - 1;
      (carry !== 0 || i < length) && it1 !== -1;
      it1--, i++)
      {
        carry += 256 * b58[it1] >>> 0;
        b58[it1] = carry % BASE >>> 0;
        carry = carry / BASE >>> 0;
      }
      if (carry !== 0) {
        throw new Error("Non-zero carry");
      }
      length = i;
      pbegin++;
    }
    // Skip leading zeroes in base58 result.
    var it2 = size - length;
    while (it2 !== size && b58[it2] === 0) {
      it2++;
    }
    // Translate the result into a string.
    var str = LEADER.repeat(zeroes);
    for (; it2 < size; ++it2) {
      str += ALPHABET.charAt(b58[it2]);
    }
    return str;
  }
  function decodeUnsafe(source) {
    if (typeof source !== "string") {
      throw new TypeError("Expected String");
    }
    if (source.length === 0) {
      return _Buffer.alloc(0);
    }
    var psz = 0;
    // Skip leading spaces.
    if (source[psz] === " ") {
      return;
    }
    // Skip and count leading '1's.
    var zeroes = 0;
    var length = 0;
    while (source[psz] === LEADER) {
      zeroes++;
      psz++;
    }
    // Allocate enough space in big-endian base256 representation.
    var size = (source.length - psz) * FACTOR + 1 >>> 0; // log(58) / log(256), rounded up.
    var b256 = new Uint8Array(size);
    // Process the characters.
    while (source[psz]) {
      // Decode character
      var carry = BASE_MAP[source.charCodeAt(psz)];
      // Invalid character
      if (carry === 255) {
        return;
      }
      var i = 0;
      for (
      var it3 = size - 1;
      (carry !== 0 || i < length) && it3 !== -1;
      it3--, i++)
      {
        carry += BASE * b256[it3] >>> 0;
        b256[it3] = carry % 256 >>> 0;
        carry = carry / 256 >>> 0;
      }
      if (carry !== 0) {
        throw new Error("Non-zero carry");
      }
      length = i;
      psz++;
    }
    // Skip trailing spaces.
    if (source[psz] === " ") {
      return;
    }
    // Skip leading zeroes in b256.
    var it4 = size - length;
    while (it4 !== size && b256[it4] === 0) {
      it4++;
    }
    var vch = _Buffer.allocUnsafe(zeroes + (size - it4));
    vch.fill(0x00, 0, zeroes);
    var j = zeroes;
    while (it4 !== size) {
      vch[j++] = b256[it4++];
    }
    return vch;
  }
  function decode(string) {
    var buffer = decodeUnsafe(string);
    if (buffer) {
      return buffer;
    }
    throw new Error("Non-base" + BASE + " character");
  }
  return {
    encode: encode,
    decodeUnsafe: decodeUnsafe,
    decode: decode };

}

var ALPHABET = "123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";var _default =

basex(ALPHABET);exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9iczU4L2luZGV4LmpzIl0sIm5hbWVzIjpbIl9CdWZmZXIiLCJyZXF1aXJlIiwiQnVmZmVyIiwiYmFzZXgiLCJBTFBIQUJFVCIsImxlbmd0aCIsIlR5cGVFcnJvciIsIkJBU0VfTUFQIiwiVWludDhBcnJheSIsImZpbGwiLCJpIiwieCIsImNoYXJBdCIsInhjIiwiY2hhckNvZGVBdCIsIkJBU0UiLCJMRUFERVIiLCJGQUNUT1IiLCJNYXRoIiwibG9nIiwiaUZBQ1RPUiIsImVuY29kZSIsInNvdXJjZSIsImlzQnVmZmVyIiwiemVyb2VzIiwicGJlZ2luIiwicGVuZCIsInNpemUiLCJiNTgiLCJjYXJyeSIsIml0MSIsIkVycm9yIiwiaXQyIiwic3RyIiwicmVwZWF0IiwiZGVjb2RlVW5zYWZlIiwiYWxsb2MiLCJwc3oiLCJiMjU2IiwiaXQzIiwiaXQ0IiwidmNoIiwiYWxsb2NVbnNhZmUiLCJqIiwiZGVjb2RlIiwic3RyaW5nIiwiYnVmZmVyIl0sIm1hcHBpbmdzIjoib0dBQUEsSUFBSUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsZ0JBQUQsQ0FBUCxDQUEwQkMsTUFBeEM7O0FBRUEsU0FBU0MsS0FBVCxDQUFlQyxRQUFmLEVBQXlCO0FBQ3JCLE1BQUlBLFFBQVEsQ0FBQ0MsTUFBVCxJQUFtQixHQUF2QixFQUE0QjtBQUN4QixVQUFNLElBQUlDLFNBQUosQ0FBYyxtQkFBZCxDQUFOO0FBQ0g7QUFDRCxNQUFJQyxRQUFRLEdBQUcsSUFBSUMsVUFBSixDQUFlLEdBQWYsQ0FBZjtBQUNBRCxFQUFBQSxRQUFRLENBQUNFLElBQVQsQ0FBYyxHQUFkO0FBQ0EsT0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHTixRQUFRLENBQUNDLE1BQTdCLEVBQXFDSyxDQUFDLEVBQXRDLEVBQTBDO0FBQ3RDLFFBQUlDLENBQUMsR0FBR1AsUUFBUSxDQUFDUSxNQUFULENBQWdCRixDQUFoQixDQUFSO0FBQ0EsUUFBSUcsRUFBRSxHQUFHRixD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QUFDQUMsSUFBQUEsR0FBRyxDQUFDaEMsSUFBSixDQUFTLElBQVQsRUFBZSxDQUFmLEVBQWtCZSxNQUFsQjtBQUNBLFFBQUltQixDQUFDLEdBQUduQixNQUFSO0FBQ0EsV0FBT2dCLEdBQUcsS0FBS2IsSUFBZixFQUFxQjtBQUNqQmMsTUFBQUEsR0FBRyxDQUFDRSxDQUFDLEVBQUYsQ0FBSCxHQUFXTCxJQUFJLENBQUNFLEdBQUcsRUFBSixDQUFmO0FBQ0g7QUFDRCxXQUFPQyxHQUFQO0FBQ0g7QUFDRCxXQUFTRyxNQUFULENBQWdCQyxNQUFoQixFQUF3QjtBQUNwQixRQUFJQyxNQUFNLEdBQUdYLFlBQVksQ0FBQ1UsTUFBRCxDQUF6QjtBQUNBLFFBQUlDLE1BQUosRUFBWTtBQUNSLGFBQU9BLE1BQVA7QUFDSDtBQUNELFVBQU0sSUFBSWYsS0FBSixDQUFVLGFBQWFoQixJQUFiLEdBQW9CLFlBQTlCLENBQU47QUFDSDtBQUNELFNBQU87QUFDSE0sSUFBQUEsTUFBTSxFQUFFQSxNQURMO0FBRUhjLElBQUFBLFlBQVksRUFBRUEsWUFGWDtBQUdIUyxJQUFBQSxNQUFNLEVBQUVBLE1BSEwsRUFBUDs7QUFLSDs7QUFFRCxJQUFJeEMsUUFBUSxHQUFHLDREQUFmLEM7O0FBRWVELEtBQUssQ0FBQ0MsUUFBRCxDIiwic291cmNlc0NvbnRlbnQiOlsidmFyIF9CdWZmZXIgPSByZXF1aXJlKFwiLi4vc2FmZS1idWZmZXJcIikuQnVmZmVyO1xuXG5mdW5jdGlvbiBiYXNleChBTFBIQUJFVCkge1xuICAgIGlmIChBTFBIQUJFVC5sZW5ndGggPj0gMjU1KSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBbHBoYWJldCB0b28gbG9uZ1wiKTtcbiAgICB9XG4gICAgdmFyIEJBU0VfTUFQID0gbmV3IFVpbnQ4QXJyYXkoMjU2KTtcbiAgICBCQVNFX01BUC5maWxsKDI1NSk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBBTFBIQUJFVC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgeCA9IEFMUEhBQkVULmNoYXJBdChpKTtcbiAgICAgICAgdmFyIHhjID0geC5jaGFyQ29kZUF0KDApO1xuICAgICAgICBpZiAoQkFTRV9NQVBbeGNdICE9PSAyNTUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoeCArIFwiIGlzIGFtYmlndW91c1wiKTtcbiAgICAgICAgfVxuICAgICAgICBCQVNFX01BUFt4Y10gPSBpO1xuICAgIH1cbiAgICB2YXIgQkFTRSA9IEFMUEhBQkVULmxlbmd0aDtcbiAgICB2YXIgTEVBREVSID0gQUxQSEFCRVQuY2hhckF0KDApO1xuICAgIHZhciBGQUNUT1IgPSBNYXRoLmxvZyhCQVNFKSAvIE1hdGgubG9nKDI1Nik7IC8vIGxvZyhCQVNFKSAvIGxvZygyNTYpLCByb3VuZGVkIHVwXG4gICAgdmFyIGlGQUNUT1IgPSBNYXRoLmxvZygyNTYpIC8gTWF0aC5sb2coQkFTRSk7IC8vIGxvZygyNTYpIC8gbG9nKEJBU0UpLCByb3VuZGVkIHVwXG4gICAgZnVuY3Rpb24gZW5jb2RlKHNvdXJjZSkge1xuICAgICAgICBpZiAoIV9CdWZmZXIuaXNCdWZmZXIoc291cmNlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkV4cGVjdGVkIEJ1ZmZlclwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc291cmNlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2tpcCAmIGNvdW50IGxlYWRpbmcgemVyb2VzLlxuICAgICAgICB2YXIgemVyb2VzID0gMDtcbiAgICAgICAgdmFyIGxlbmd0aCA9IDA7XG4gICAgICAgIHZhciBwYmVnaW4gPSAwO1xuICAgICAgICB2YXIgcGVuZCA9IHNvdXJjZS5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChwYmVnaW4gIT09IHBlbmQgJiYgc291cmNlW3BiZWdpbl0gPT09IDApIHtcbiAgICAgICAgICAgIHBiZWdpbisrO1xuICAgICAgICAgICAgemVyb2VzKys7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQWxsb2NhdGUgZW5vdWdoIHNwYWNlIGluIGJpZy1lbmRpYW4gYmFzZTU4IHJlcHJlc2VudGF0aW9uLlxuICAgICAgICB2YXIgc2l6ZSA9ICgocGVuZCAtIHBiZWdpbikgKiBpRkFDVE9SICsgMSkgPj4+IDA7XG4gICAgICAgIHZhciBiNTggPSBuZXcgVWludDhBcnJheShzaXplKTtcbiAgICAgICAgLy8gUHJvY2VzcyB0aGUgYnl0ZXMuXG4gICAgICAgIHdoaWxlIChwYmVnaW4gIT09IHBlbmQpIHtcbiAgICAgICAgICAgIHZhciBjYXJyeSA9IHNvdXJjZVtwYmVnaW5dO1xuICAgICAgICAgICAgLy8gQXBwbHkgXCJiNTggPSBiNTggKiAyNTYgKyBjaFwiLlxuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZm9yIChcbiAgICAgICAgICAgICAgICB2YXIgaXQxID0gc2l6ZSAtIDE7XG4gICAgICAgICAgICAgICAgKGNhcnJ5ICE9PSAwIHx8IGkgPCBsZW5ndGgpICYmIGl0MSAhPT0gLTE7XG4gICAgICAgICAgICAgICAgaXQxLS0sIGkrK1xuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgY2FycnkgKz0gKDI1NiAqIGI1OFtpdDFdKSA+Pj4gMDtcbiAgICAgICAgICAgICAgICBiNThbaXQxXSA9IGNhcnJ5ICUgQkFTRSA+Pj4gMDtcbiAgICAgICAgICAgICAgICBjYXJyeSA9IChjYXJyeSAvIEJBU0UpID4+PiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNhcnJ5ICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm9uLXplcm8gY2FycnlcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZW5ndGggPSBpO1xuICAgICAgICAgICAgcGJlZ2luKys7XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2tpcCBsZWFkaW5nIHplcm9lcyBpbiBiYXNlNTggcmVzdWx0LlxuICAgICAgICB2YXIgaXQyID0gc2l6ZSAtIGxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGl0MiAhPT0gc2l6ZSAmJiBiNThbaXQyXSA9PT0gMCkge1xuICAgICAgICAgICAgaXQyKys7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVHJhbnNsYXRlIHRoZSByZXN1bHQgaW50byBhIHN0cmluZy5cbiAgICAgICAgdmFyIHN0ciA9IExFQURFUi5yZXBlYXQoemVyb2VzKTtcbiAgICAgICAgZm9yICg7IGl0MiA8IHNpemU7ICsraXQyKSB7XG4gICAgICAgICAgICBzdHIgKz0gQUxQSEFCRVQuY2hhckF0KGI1OFtpdDJdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH1cbiAgICBmdW5jdGlvbiBkZWNvZGVVbnNhZmUoc291cmNlKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc291cmNlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXhwZWN0ZWQgU3RyaW5nXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzb3VyY2UubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gX0J1ZmZlci5hbGxvYygwKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHN6ID0gMDtcbiAgICAgICAgLy8gU2tpcCBsZWFkaW5nIHNwYWNlcy5cbiAgICAgICAgaWYgKHNvdXJjZVtwc3pdID09PSBcIiBcIikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNraXAgYW5kIGNvdW50IGxlYWRpbmcgJzEncy5cbiAgICAgICAgdmFyIHplcm9lcyA9IDA7XG4gICAgICAgIHZhciBsZW5ndGggPSAwO1xuICAgICAgICB3aGlsZSAoc291cmNlW3Bzel0gPT09IExFQURFUikge1xuICAgICAgICAgICAgemVyb2VzKys7XG4gICAgICAgICAgICBwc3orKztcbiAgICAgICAgfVxuICAgICAgICAvLyBBbGxvY2F0ZSBlbm91Z2ggc3BhY2UgaW4gYmlnLWVuZGlhbiBiYXNlMjU2IHJlcHJlc2VudGF0aW9uLlxuICAgICAgICB2YXIgc2l6ZSA9ICgoc291cmNlLmxlbmd0aCAtIHBzeikgKiBGQUNUT1IgKyAxKSA+Pj4gMDsgLy8gbG9nKDU4KSAvIGxvZygyNTYpLCByb3VuZGVkIHVwLlxuICAgICAgICB2YXIgYjI1NiA9IG5ldyBVaW50OEFycmF5KHNpemUpO1xuICAgICAgICAvLyBQcm9jZXNzIHRoZSBjaGFyYWN0ZXJzLlxuICAgICAgICB3aGlsZSAoc291cmNlW3Bzel0pIHtcbiAgICAgICAgICAgIC8vIERlY29kZSBjaGFyYWN0ZXJcbiAgICAgICAgICAgIHZhciBjYXJyeSA9IEJBU0VfTUFQW3NvdXJjZS5jaGFyQ29kZUF0KHBzeildO1xuICAgICAgICAgICAgLy8gSW52YWxpZCBjaGFyYWN0ZXJcbiAgICAgICAgICAgIGlmIChjYXJyeSA9PT0gMjU1KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZm9yIChcbiAgICAgICAgICAgICAgICB2YXIgaXQzID0gc2l6ZSAtIDE7XG4gICAgICAgICAgICAgICAgKGNhcnJ5ICE9PSAwIHx8IGkgPCBsZW5ndGgpICYmIGl0MyAhPT0gLTE7XG4gICAgICAgICAgICAgICAgaXQzLS0sIGkrK1xuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgY2FycnkgKz0gKEJBU0UgKiBiMjU2W2l0M10pID4+PiAwO1xuICAgICAgICAgICAgICAgIGIyNTZbaXQzXSA9IGNhcnJ5ICUgMjU2ID4+PiAwO1xuICAgICAgICAgICAgICAgIGNhcnJ5ID0gKGNhcnJ5IC8gMjU2KSA+Pj4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjYXJyeSAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vbi16ZXJvIGNhcnJ5XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGVuZ3RoID0gaTtcbiAgICAgICAgICAgIHBzeisrO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNraXAgdHJhaWxpbmcgc3BhY2VzLlxuICAgICAgICBpZiAoc291cmNlW3Bzel0gPT09IFwiIFwiKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2tpcCBsZWFkaW5nIHplcm9lcyBpbiBiMjU2LlxuICAgICAgICB2YXIgaXQ0ID0gc2l6ZSAtIGxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGl0NCAhPT0gc2l6ZSAmJiBiMjU2W2l0NF0gPT09IDApIHtcbiAgICAgICAgICAgIGl0NCsrO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2Y2ggPSBfQnVmZmVyLmFsbG9jVW5zYWZlKHplcm9lcyArIChzaXplIC0gaXQ0KSk7XG4gICAgICAgIHZjaC5maWxsKDB4MDAsIDAsIHplcm9lcyk7XG4gICAgICAgIHZhciBqID0gemVyb2VzO1xuICAgICAgICB3aGlsZSAoaXQ0ICE9PSBzaXplKSB7XG4gICAgICAgICAgICB2Y2hbaisrXSA9IGIyNTZbaXQ0KytdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2Y2g7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGRlY29kZShzdHJpbmcpIHtcbiAgICAgICAgdmFyIGJ1ZmZlciA9IGRlY29kZVVuc2FmZShzdHJpbmcpO1xuICAgICAgICBpZiAoYnVmZmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gYnVmZmVyO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vbi1iYXNlXCIgKyBCQVNFICsgXCIgY2hhcmFjdGVyXCIpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBlbmNvZGU6IGVuY29kZSxcbiAgICAgICAgZGVjb2RlVW5zYWZlOiBkZWNvZGVVbnNhZmUsXG4gICAgICAgIGRlY29kZTogZGVjb2RlXG4gICAgfTtcbn1cblxudmFyIEFMUEhBQkVUID0gXCIxMjM0NTY3ODlBQkNERUZHSEpLTE1OUFFSU1RVVldYWVphYmNkZWZnaGlqa21ub3BxcnN0dXZ3eHl6XCI7XG5cbmV4cG9ydCBkZWZhdWx0IGJhc2V4KEFMUEhBQkVUKTtcbiJdfQ==